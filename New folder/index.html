<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Urban Resolve - Citizen Engagement System</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #2563eb;
      --secondary-color: #1e40af;
      --background-color: #f3f4f6;
      --text-color: #1f2937;
      --success-color: #10b981;
      --warning-color: #f59e0b;
      --error-color: #ef4444;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      background-color: var(--background-color);
      color: var(--text-color);
    }

    header {
      background-color: white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 1rem 2rem;
      position: fixed;
      width: 100%;
      top: 0;
      z-index: 1000;
    }

    .header-content {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .logo {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--primary-color);
      font-size: 1.5rem;
      font-weight: bold;
    }

    nav {
      display: flex;
      gap: 1.5rem;
    }

    nav a {
      color: var(--text-color);
      text-decoration: none;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: color 0.3s;
    }

    nav a:hover {
      color: var(--primary-color);
    }

    main {
      max-width: 1200px;
      margin: 6rem auto 2rem;
      padding: 0 2rem;
    }

    .hero {
      text-align: center;
      padding: 3rem 0;
      background: linear-gradient(to right, #2563eb11, #1e40af11);
      border-radius: 1rem;
      margin-bottom: 2rem;
    }

    .hero h1 {
      font-size: 2.5rem;
      color: var(--primary-color);
      margin-bottom: 1rem;
    }

    .card {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      margin-bottom: 2rem;
    }

    .login-container {
      max-width: 400px;
      margin: 0 auto;
    }

    .form-group {
      position: relative;
      margin-bottom: 1.5rem;
      width: 100%;
    }

    .form-group input,
    .form-group select {
      width: 100%;
      box-sizing: border-box; /* Ensure padding is included in width calculation */
      padding: 0.75rem 1rem;
      border: 1px solid var(--border-color, #e5e7eb);
      border-radius: 0.5rem;
      font-size: 1rem;
      transition: all 0.2s;
    }

    .form-group input[type="password"],
    .form-group input[type="text"] {  /* Apply to both password and text modes */
      padding-right: 2.5rem;
      width: 100%;
      box-sizing: border-box;
    }

    .password-toggle {
      position: absolute;
      right: 0.75rem;
      top: 50%;
      transform: translateY(calc(-50% + 12px)); /* Adjust for label height */
      background: none;
      border: none;
      cursor: pointer;
      color: #666;
      padding: 0.25rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s;
      z-index: 2;
      width: auto; /* Ensure button doesn't affect input width */
    }

    .password-toggle:hover {
      color: var(--primary-color);
    }

    .password-toggle i {
      font-size: 1.1rem;
      line-height: 1;
    }

    button {
      background-color: var(--primary-color);
      color: white;
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    button:hover {
      background-color: var(--secondary-color);
    }

    .complaint-card {
      background: white;
      padding: 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      margin-bottom: 1rem;
    }

    .status-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.875rem;
      font-weight: 500;
    }

    .status-submitted { background-color: #fef3c7; color: #92400e; }
    .status-progress { background-color: #dbeafe; color: #1e40af; }
    .status-resolved { background-color: #dcfce7; color: #166534; }

    .admin-buttons {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .admin-buttons button {
      flex: 1;
    }

    .auth-links {
      text-align: center;
      margin-top: 1rem;
    }

    .auth-links a {
      color: var(--primary-color);
      text-decoration: none;
      margin: 0 1rem;
    }

    .auth-links a:hover {
      text-decoration: underline;
    }

    .file-upload {
      border: 2px dashed #e5e7eb;
      padding: 1.5rem;
      text-align: center;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: border-color 0.3s;
    }

    .file-upload:hover {
      border-color: var(--primary-color);
    }

    @media (max-width: 768px) {
      nav {
        display: none;
      }
      .form-row {
        flex-direction: column;
      }
    }

    /* Mobile menu styles */
    .mobile-menu-button {
      display: none;  /* Hidden by default on desktop */
      background: none;
      border: none;
      padding: 0.75rem;
      margin-right: 0.5rem;
      color: var(--text-color);
      cursor: pointer;
      font-size: 1.25rem;
      width: 45px;
      height: 45px;
      align-items: center;
      justify-content: center;
      border-radius: 0.5rem;
    }

    .mobile-menu-button:active {
      background-color: #f3f4f6;
    }

    .mobile-menu-button:hover {
      color: var(--primary-color);
    }

    .mobile-menu {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: white;
      z-index: 2000;
      padding: 1rem;
      animation: slideInRight 0.3s ease-out;
    }

    .mobile-menu.show {
      display: block;
    }

    .mobile-menu-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding-bottom: 1rem;
      margin-bottom: 1rem;
      border-bottom: 1px solid #e5e7eb;
    }

    .mobile-menu-close {
      background: none;
      border: none;
      padding: 0.5rem;
      color: var(--text-color);
      cursor: pointer;
      font-size: 1.25rem;
    }

    .mobile-menu nav {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .mobile-menu nav a {
      padding: 1rem;
      border-radius: 0.5rem;
      transition: background-color 0.2s;
    }

    .mobile-menu nav a:hover {
      background-color: #f3f4f6;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
      }
      to {
        transform: translateX(0);
      }
    }

    @media (max-width: 768px) {
      .mobile-menu-button {
        display: flex;
      }

      nav {
        display: none;
      }

      .header-content {
        padding: 0.5rem 1rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 1rem;
      }

      .logo {
        font-size: 1.25rem;
      }

      .form-row {
        flex-direction: column;
      }

      .user-dropdown-content {
        position: fixed;
        top: auto;
        bottom: 0;
        left: 0;
        right: 0;
        border-radius: 1rem 1rem 0 0;
        animation: slideInUp 0.3s ease-out;
      }
    }

    @keyframes slideInUp {
      from {
        transform: translateY(100%);
      }
      to {
        transform: translateY(0);
      }
    }

    .notification {
      position: fixed;
      top: 5rem;
      right: 1rem;
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      background: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      z-index: 1000;
      display: flex;
      align-items: center;
      gap: 0.75rem;
      animation: slideIn 0.3s ease-out;
      max-width: 24rem;
    }

    .notification.success {
      border-left: 4px solid var(--success-color);
    }

    .notification.error {
      border-left: 4px solid var(--error-color);
    }

    .notification.warning {
      border-left: 4px solid var(--warning-color);
    }

    .notification i {
      font-size: 1.25rem;
    }

    .notification.success i {
      color: var(--success-color);
    }

    .notification.error i {
      color: var(--error-color);
    }

    .notification.warning i {
      color: var(--warning-color);
    }

    .notification-content {
      flex: 1;
    }

    .notification h4 {
      margin: 0;
      font-size: 1rem;
      font-weight: 600;
    }

    .notification p {
      margin: 0.25rem 0 0 0;
      font-size: 0.875rem;
      color: #6b7280;
    }

    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }

    .notification.hiding {
      animation: slideOut 0.3s ease-in forwards;
    }

    /* User dropdown menu styles */
    .user-dropdown {
      position: relative;
      display: inline-block;
    }

    .user-dropdown-content {
      display: none;
      position: absolute;
      right: 0;
      top: 100%;
      background-color: white;
      min-width: 180px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-radius: 0.5rem;
      padding: 0.5rem 0;
      z-index: 1000;
    }

    .user-dropdown-content.show {
      display: block;
      animation: fadeIn 0.2s ease-out;
    }

    .user-dropdown-content a {
      color: var(--text-color);
      padding: 0.75rem 1rem;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: background-color 0.2s;
    }

    .user-dropdown-content a:hover {
      background-color: #f3f4f6;
      color: var(--primary-color);
    }

    .user-dropdown-content .divider {
      height: 1px;
      background-color: #e5e7eb;
      margin: 0.5rem 0;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Add admin dashboard styles */
    .admin-dashboard {
      display: none;
      padding: 2rem;
    }

    .admin-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .stat-card {
      background: white;
      padding: 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      text-align: center;
    }

    .stat-card i {
      font-size: 2rem;
      color: var(--primary-color);
      margin-bottom: 0.5rem;
    }

    .stat-card h3 {
      margin: 0.5rem 0;
      color: var(--text-color);
    }

    .stat-card p {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--primary-color);
    }

    .admin-filters {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }

    .admin-filters select {
      min-width: 200px;
    }

    .complaints-table {
      width: 100%;
      border-collapse: collapse;
      background: white;
      border-radius: 0.5rem;
      overflow: hidden;
    }

    .complaints-table th,
    .complaints-table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #e5e7eb;
    }

    .complaints-table th {
      background: var(--primary-color);
      color: white;
    }

    .complaints-table tr:hover {
      background: #f8fafc;
    }

    .action-buttons {
      display: flex;
      gap: 0.5rem;
    }

    .action-buttons button {
      padding: 0.5rem 1rem;
      font-size: 0.875rem;
    }
  </style>
</head>
<body>
  <header>
    <div class="header-content">
      <div class="logo">
        <i class="fas fa-city"></i>
        Urban Resolve
      </div>
      <nav>
        <a href="#" onclick="showSection('home')"><i class="fas fa-home"></i> Home</a>
        <a href="#" onclick="showSection('submit')"><i class="fas fa-plus-circle"></i> Submit Issue</a>
        <a href="#" onclick="showSection('status')"><i class="fas fa-tasks"></i> Check Status</a>
        <a href="#" onclick="showSection('suggestions')"><i class="fas fa-lightbulb"></i> Suggestions</a>
        <a href="#" id="loginNav" onclick="showSection('login')"><i class="fas fa-user"></i> Login</a>
      </nav>
      <button class="mobile-menu-button" onclick="toggleMobileMenu()">
        <i class="fas fa-bars fa-lg"></i>
      </button>
    </div>
  </header>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-header">
      <div class="logo">
        <i class="fas fa-city"></i>
        Urban Resolve
      </div>
      <button class="mobile-menu-close" onclick="toggleMobileMenu()">
        <i class="fas fa-times"></i>
      </button>
    </div>
    <nav>
      <a href="#" onclick="showSectionMobile('home')"><i class="fas fa-home"></i> Home</a>
      <a href="#" onclick="showSectionMobile('submit')"><i class="fas fa-plus-circle"></i> Submit Issue</a>
      <a href="#" onclick="showSectionMobile('status')"><i class="fas fa-tasks"></i> Check Status</a>
      <a href="#" onclick="showSectionMobile('suggestions')"><i class="fas fa-lightbulb"></i> Suggestions</a>
      <a href="#" id="loginNavMobile" onclick="showSectionMobile('login')"><i class="fas fa-user"></i> Login</a>
    </nav>
  </div>

  <main>
    <div id="home">
      <div class="hero">
        <h1><i class="fas fa-city"></i> Welcome to Urban Resolve</h1>
        <p>Your voice matters! Report issues and help improve our community together.</p>
      </div>
      <div class="card">
        <h2><i class="fas fa-info-circle"></i> About Us</h2>
        <p>Urban Resolve is your trusted community engagement platform, empowering citizens to report concerns, share feedback, and collaborate with local authorities for better public services and community wellbeing. We're here to ensure your voice drives meaningful change. Together, we build stronger and better communities.</p>
        <div style="display: flex; gap: 1rem; margin-top: 2rem;">
          <div style="flex: 1; text-align: center;">
            <i class="fas fa-clock fa-2x" style="color: var(--primary-color)"></i>
            <h3>Quick Response</h3>
            <p>Get updates on your complaints within 24-48 hours</p>
          </div>
          <div style="flex: 1; text-align: center;">
            <i class="fas fa-chart-line fa-2x" style="color: var(--primary-color)"></i>
            <h3>Track Progress</h3>
            <p>Monitor the status of your complaints in real-time</p>
          </div>
          <div style="flex: 1; text-align: center;">
            <i class="fas fa-hands-helping fa-2x" style="color: var(--primary-color)"></i>
            <h3>Community Impact</h3>
            <p>Join others in making our community better</p>
          </div>
        </div>
      </div>
    </div>

    <div id="login" style="display:none;">
      <div class="login-container card">
        <h2><i class="fas fa-user"></i> User Login</h2>
        <div class="form-group">
          <label for="loginEmail">Email Address</label>
          <input type="email" id="loginEmail" placeholder="Enter your email" />
        </div>
        <div class="form-group">
          <label for="loginPassword">Password</label>
          <input type="password" id="loginPassword" placeholder="Enter your password" />
          <button type="button" class="password-toggle" onclick="togglePassword('loginPassword')">
            <i class="fas fa-eye"></i>
          </button>
        </div>
        <button onclick="loginUser()">Login</button>
        <div class="auth-links">
          <p style="margin: 1rem 0;">Don't have an account? <a href="#" onclick="showUserSignup()">Sign up</a></p>
          <a href="#" onclick="showSection('forgot-password')">Forgot Password?</a>
        </div>
      </div>
    </div>

    <div id="signup" style="display:none;">
      <div class="login-container card">
        <h2 id="signupTitle"><i class="fas fa-user-plus"></i> Create Account</h2>
        <div id="adminFields" style="display: none;">
          <div class="form-group">
            <label>Department</label>
            <select id="adminDepartment" required>
              <option value="">Select Department</option>
              <option value="water">Water Department</option>
              <option value="electricity">Electricity Department</option>
              <option value="roads">Roads & Transportation</option>
              <option value="waste">Waste Management</option>
              <option value="sanitation">Sanitation Department</option>
              <option value="healthcare">Healthcare Department</option>
              <option value="education">Education Department</option>
              <option value="safety">Public Safety Department</option>
            </select>
          </div>
          <div class="form-group">
            <label>Position</label>
            <input type="text" id="adminPosition" placeholder="Enter your position" />
          </div>
          <div class="form-group">
            <label>Employee ID</label>
            <input type="text" id="adminEmployeeId" placeholder="Enter your employee ID" />
          </div>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label for="signupFirstName">First Name</label>
            <input type="text" id="signupFirstName" required />
          </div>
          <div class="form-group">
            <label for="signupLastName">Last Name</label>
            <input type="text" id="signupLastName" required />
          </div>
        </div>
        <div class="form-group">
          <label for="signupEmail">Email Address</label>
          <input type="email" id="signupEmail" required />
        </div>
        <div class="form-group">
          <label for="signupPhone">Phone Number</label>
          <input type="tel" id="signupPhone" required />
        </div>
        <div class="form-group">
          <label for="signupPassword">Password</label>
          <input type="password" id="signupPassword" required onkeyup="validatePassword()" />
          <small id="passwordHint" style="color: #666; display: none;">Password must be at least 6 characters long</small>
        </div>
        <div class="form-group">
          <label for="signupConfirmPassword">Confirm Password</label>
          <input type="password" id="signupConfirmPassword" required onkeyup="validatePassword()" />
          <small id="passwordMatch" style="display: none;"></small>
        </div>
        <button onclick="signupUser()">Create Account</button>
        <div class="auth-links">
          <a href="#" id="backToLogin" onclick="showSection('login')">Already have an account? Login</a>
        </div>
      </div>
    </div>

    <div id="forgot-password" style="display:none;">
      <div class="login-container card">
        <h2><i class="fas fa-key"></i> Reset Password</h2>
        <p>Enter your email address and we'll send you instructions to reset your password.</p>
        <div class="form-group">
          <label for="resetEmail">Email Address</label>
          <input type="email" id="resetEmail" placeholder="Enter your email" />
        </div>
        <button onclick="resetPassword()">Send Reset Link</button>
        <div class="auth-links">
          <a href="#" onclick="showSection('login')">Back to Login</a>
        </div>
      </div>
    </div>

    <div id="admin-login" style="display:none;">
      <div class="login-container card">
        <h2><i class="fas fa-lock"></i> Admin Portal</h2>
        <div class="form-group">
          <label for="adminEmail">Admin Email</label>
          <input type="email" id="adminEmail" placeholder="Enter admin email" />
        </div>
        <div class="form-group">
          <label for="adminPassword">Password</label>
          <input type="password" id="adminPassword" placeholder="Enter admin password" />
          <button type="button" class="password-toggle" onclick="togglePassword('adminPassword')">
            <i class="fas fa-eye"></i>
          </button>
        </div>
        <button onclick="loginAdmin()">Login</button>
        <div class="auth-links">
          <p style="margin: 1rem 0;">Don't have an account? <a href="#" onclick="showAdminSignup()">Sign up as Administrator</a></p>
          <a href="#" onclick="showSection('forgot-password')">Forgot Password?</a>
        </div>
      </div>
    </div>

    <div id="form-section" style="display:none;">
      <div class="card">
        <h2><i class="fas fa-edit"></i> Submit Complaint / Feedback</h2>
      <form id="complaintForm" onsubmit="submitComplaint(event)">
          <div class="form-row">
            <div class="form-group">
              <label for="name">Full Name</label>
              <input type="text" id="name" required />
            </div>
            <div class="form-group">
              <label for="phone">Phone Number</label>
              <input type="tel" id="phone" required />
            </div>
          </div>
          <div class="form-row">
            <div class="form-group">
              <label for="category">Category</label>
              <select id="category" required>
                <option value="">Select a category</option>
                <option value="water"><i class="fas fa-water"></i> Water Supply</option>
                <option value="electricity"><i class="fas fa-bolt"></i> Electricity</option>
                <option value="roads"><i class="fas fa-road"></i> Roads & Transportation</option>
                <option value="waste"><i class="fas fa-trash"></i> Waste Management</option>
                <option value="sanitation"><i class="fas fa-broom"></i> Sanitation</option>
                <option value="healthcare"><i class="fas fa-hospital"></i> Healthcare</option>
                <option value="education"><i class="fas fa-school"></i> Education</option>
                <option value="safety"><i class="fas fa-shield-alt"></i> Public Safety</option>
                <option value="other"><i class="fas fa-question-circle"></i> Other</option>
        </select>
            </div>
            <div class="form-group">
              <label for="location">Location</label>
              <input type="text" id="location" placeholder="Enter address or area" required />
            </div>
          </div>
          <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" rows="4" placeholder="Please provide detailed information about the issue..." required></textarea>
          </div>
          <div class="form-group">
            <label>Supporting Documents</label>
            <div class="file-upload" onclick="document.getElementById('fileInput').click()">
              <i class="fas fa-cloud-upload-alt fa-2x"></i>
              <p>Click to upload photos or documents</p>
              <input type="file" id="fileInput" style="display: none" multiple accept="image/*,.pdf,.doc,.docx" />
            </div>
          </div>
          <button type="submit"><i class="fas fa-paper-plane"></i> Submit Complaint</button>
      </form>
      </div>
    </div>

    <div id="complaint-list" style="display:none;">
      <div class="card">
        <h2><i class="fas fa-clipboard-list"></i> Complaint Status Dashboard</h2>
        <p class="subtitle" style="color: #666; margin-bottom: 2rem;">Track and monitor the status of your submitted complaints</p>
        
        <div class="status-summary" style="display: flex; gap: 1rem; margin-bottom: 2rem;">
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-paper-plane fa-lg" style="color: var(--primary-color);"></i>
            <h4>Submitted</h4>
            <p id="submitted-count">0</p>
          </div>
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-clock fa-lg" style="color: var(--warning-color);"></i>
            <h4>In Progress</h4>
            <p id="progress-count">0</p>
          </div>
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-check-circle fa-lg" style="color: var(--success-color);"></i>
            <h4>Resolved</h4>
            <p id="resolved-count">0</p>
          </div>
        </div>

        <h3 style="margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb;">
          <i class="fas fa-list"></i> Your Complaints
        </h3>
        
        <div id="no-complaints-message" style="display: none;">
          <div style="text-align: center; padding: 2rem; background: #f8fafc; border-radius: 0.5rem;">
            <i class="fas fa-inbox fa-3x" style="color: var(--primary-color); margin-bottom: 1rem;"></i>
            <h3 style="color: #374151; margin-bottom: 0.5rem;">No Complaints Yet</h3>
            <p style="color: #6b7280; margin-bottom: 1.5rem;">You haven't submitted any complaints yet. When you do, they will appear here with their current status.</p>
            <button onclick="showSection('submit')" style="margin-top: 1rem;">
              <i class="fas fa-plus-circle"></i> Submit New Complaint
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="suggestions" style="display:none;">
      <div class="card">
        <h2><i class="fas fa-lightbulb"></i> Community Suggestions</h2>
        <p>Share your ideas to improve our community! Your suggestions help make our city better.</p>
        <form id="suggestionForm">
          <div class="form-group">
            <label for="suggestionTitle">Title</label>
            <input type="text" id="suggestionTitle" placeholder="Brief title for your suggestion" required />
          </div>
          <div class="form-group">
            <label for="suggestionCategory">Category</label>
            <select id="suggestionCategory" required>
              <option value="">Select a category</option>
              <option value="infrastructure">Infrastructure</option>
              <option value="environment">Environment</option>
              <option value="community">Community Services</option>
              <option value="safety">Public Safety</option>
              <option value="other">Other</option>
            </select>
          </div>
          <div class="form-group">
            <label for="suggestionDescription">Description</label>
            <textarea id="suggestionDescription" rows="4" placeholder="Describe your suggestion in detail..." required></textarea>
          </div>
          <button type="submit"><i class="fas fa-paper-plane"></i> Submit Suggestion</button>
        </form>
      </div>
      <div id="suggestions-list" class="card">
        <h3>Recent Suggestions</h3>
        <!-- Suggestions will be displayed here -->
      </div>
    </div>

    <div id="admin-dashboard" class="admin-dashboard">
      <h2><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h2>
      
      <div class="admin-stats">
        <div class="stat-card">
          <i class="fas fa-inbox"></i>
          <h3>New Complaints</h3>
          <p id="new-complaints-count">0</p>
        </div>
        <div class="stat-card">
          <i class="fas fa-clock"></i>
          <h3>In Progress</h3>
          <p id="in-progress-count">0</p>
        </div>
        <div class="stat-card">
          <i class="fas fa-check-circle"></i>
          <h3>Resolved</h3>
          <p id="resolved-complaints-count">0</p>
        </div>
        <div class="stat-card">
          <i class="fas fa-chart-line"></i>
          <h3>Response Rate</h3>
          <p id="response-rate">0%</p>
        </div>
      </div>

      <div class="admin-filters">
        <select id="department-filter" onchange="filterComplaints()">
          <option value="">All Departments</option>
          <option value="water">Water Department</option>
          <option value="electricity">Electricity Department</option>
          <option value="roads">Roads & Transportation</option>
          <option value="waste">Waste Management</option>
          <option value="sanitation">Sanitation</option>
          <option value="healthcare">Healthcare</option>
          <option value="education">Education</option>
          <option value="safety">Public Safety</option>
        </select>
        <select id="status-filter" onchange="filterComplaints()">
          <option value="">All Status</option>
          <option value="Submitted">New</option>
          <option value="In Progress">In Progress</option>
          <option value="Resolved">Resolved</option>
        </select>
        <input type="date" id="date-filter" onchange="filterComplaints()">
      </div>

      <div class="card">
        <table class="complaints-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>Date</th>
              <th>Category</th>
              <th>Description</th>
              <th>Location</th>
              <th>Status</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="complaints-table-body">
            <!-- Complaints will be populated here -->
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
  <script>
    // Socket.IO connection
    const socket = io('http://localhost:5000');
    
    socket.on('connect', () => {
      console.log('Connected to server');
    });
    
    socket.on('disconnect', () => {
      console.log('Disconnected from server');
    });
    
    // Join user-specific room on login
    function joinUserRoom(email) {
      socket.emit('join_room', email);
    }
    
    // Join admin room for admin users
    function joinAdminRoom() {
      socket.emit('join_room', 'admin');
    }
    
    // Listen for complaint updates
    socket.on('complaint_update', (complaint) => {
      // Update the complaints array
      const index = complaints.findIndex(c => c.id === complaint.id);
      if (index !== -1) {
        complaints[index] = complaint;
      } else {
        complaints.push(complaint);
      }
      
      // Re-render the complaints list
      if (document.getElementById('complaint-list').style.display === 'block') {
        renderComplaints();
      }
      
      // Show notification
      showNotification(
        'info',
        'Complaint Updated',
        `Complaint #${complaint.id} has been updated to ${complaint.status}`
      );
    });
    
    // Listen for new complaints (admin only)
    socket.on('new_complaint', (complaint) => {
      if (adminMode) {
        complaints.push(complaint);
        if (document.getElementById('admin-dashboard').style.display === 'block') {
          renderComplaintsTable();
          updateAdminStats();
        }
        
        showNotification(
          'info',
          'New Complaint',
          `A new complaint has been submitted by ${complaint.name}`
        );
      }
    });

    // Password Toggle Function
    function togglePassword(inputId) {
      const input = document.getElementById(inputId);
      const icon = event.currentTarget.querySelector('i');
      
      if (input.type === 'password') {
        input.type = 'text';
        icon.classList.remove('fa-eye');
        icon.classList.add('fa-eye-slash');
      } else {
        input.type = 'password';
        icon.classList.remove('fa-eye-slash');
        icon.classList.add('fa-eye');
      }
    }

    // Initialize arrays for storing data
    let complaints = [];
    let suggestions = [];
    
    // User session state
    let adminMode = false;
    let currentUserEmail = '';
    let currentUserName = '';
    let currentUserDepartment = '';
    let currentUserRole = '';

    function showNotification(type, title, message) {
      // Remove any existing notification
      const existingNotification = document.querySelector('.notification');
      if (existingNotification) {
        existingNotification.remove();
      }

      // Create new notification
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      
      let icon = '';
      switch(type) {
        case 'success':
          icon = 'check-circle';
          break;
        case 'error':
          icon = 'exclamation-circle';
          break;
        case 'warning':
          icon = 'exclamation-triangle';
          break;
        default:
          icon = 'info-circle';
      }

      notification.innerHTML = `
        <i class="fas fa-${icon}"></i>
        <div class="notification-content">
          <h4>${title}</h4>
          <p>${message}</p>
        </div>
      `;

      document.body.appendChild(notification);

      // Remove notification after 5 seconds
      setTimeout(() => {
        notification.classList.add('hiding');
        setTimeout(() => notification.remove(), 300);
      }, 5000);
    }

    function validatePassword() {
      const password = document.getElementById("signupPassword").value;
      const confirmPassword = document.getElementById("signupConfirmPassword").value;
      const passwordHint = document.getElementById("passwordHint");
      const passwordMatch = document.getElementById("passwordMatch");
      
      // Show password length requirement
      if (password) {
        passwordHint.style.display = 'block';
        if (password.length < 6) {
          passwordHint.style.color = '#ef4444';
        } else {
          passwordHint.style.color = '#10b981';
        }
      } else {
        passwordHint.style.display = 'none';
      }
      
      // Show password match status
      if (password && confirmPassword) {
        passwordMatch.style.display = 'block';
        if (password === confirmPassword) {
          passwordMatch.style.color = '#10b981';
          passwordMatch.textContent = 'Passwords match';
        } else {
          passwordMatch.style.color = '#ef4444';
          passwordMatch.textContent = 'Passwords do not match';
        }
      } else {
        passwordMatch.style.display = 'none';
      }
    }

    // Mock user credentials (in a real app, this would be handled server-side)
    const users = [
      { email: 'user@example.com', password: 'user123', firstName: 'Demo', lastName: 'User', role: 'user' },
      { 
        email: 'admin@example.com', 
        password: 'admin123', 
        firstName: 'Admin', 
        lastName: 'User', 
        role: 'admin',
        department: 'all',
        position: 'Super Admin',
        employeeId: 'SA001'
      }
    ];

    const form = document.getElementById("complaintForm");
    const suggestionForm = document.getElementById("suggestionForm");

    function submitComplaint(e) {
      e.preventDefault();
      
      if (!currentUserEmail) {
        showNotification('warning', 'Login Required', 'Please login to submit a complaint');
        showSection('login');
        return;
      }
      
      // Pre-fill name with logged in user's name if available
      if (currentUserName && !document.getElementById("name").value) {
        document.getElementById("name").value = currentUserName;
      }

      const complaint = {
        id: complaints.length + 1,
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        email: currentUserEmail, // Use logged in user's email
        category: document.getElementById("category").value,
        location: document.getElementById("location").value,
        description: document.getElementById("description").value,
        status: "Submitted",
        date: new Date().toLocaleDateString()
      };

      // Add the complaint to the array
      complaints.push(complaint);
      console.log('New complaint added:', complaint); // Debug log
      console.log('Total complaints:', complaints.length); // Debug log
      
      // Reset form and update UI
      form.reset();
      showSection('status');
      renderComplaints();
      showNotification('success', 'Complaint Submitted', 'Your complaint has been successfully submitted. You can track its status in the dashboard.');
    }

    // Handle suggestion form submission
    suggestionForm.addEventListener("submit", function(e) {
      e.preventDefault();
      
      if (!currentUserEmail) {
        showNotification('warning', 'Login Required', 'Please login to submit a suggestion');
        showSection('login');
        return;
      }

      const suggestion = {
        id: suggestions.length + 1,
        title: document.getElementById("suggestionTitle").value,
        category: document.getElementById("suggestionCategory").value,
        description: document.getElementById("suggestionDescription").value,
        name: currentUserName || currentUserEmail,
        date: new Date().toLocaleDateString(),
        votes: 0
      };

      suggestions.push(suggestion);
      suggestionForm.reset();
      renderSuggestions();
      showNotification('success', 'Suggestion Submitted', 'Your suggestion has been successfully submitted. Thank you for contributing to our community!');
    });

    function updateNavigation() {
      const loginNav = document.getElementById('loginNav');
      const loginNavMobile = document.getElementById('loginNavMobile');
      
      if (currentUserEmail) {
        // Update desktop nav
        loginNav.className = 'user-dropdown';
        loginNav.innerHTML = `
          <a href="#" onclick="toggleUserDropdown(event)">
            <i class="fas fa-user"></i> ${currentUserName || currentUserEmail}
          </a>
          <div class="user-dropdown-content" id="userDropdown">
            <div style="padding: 0.75rem 1rem;">
              <div style="font-weight: 500;">${currentUserName || currentUserEmail}</div>
              <div style="font-size: 0.875rem; color: #666;">${currentUserRole}</div>
            </div>
            <div class="divider"></div>
            ${currentUserRole === 'admin' ? 
              `<a href="#" onclick="showSection('status')">
                <i class="fas fa-clipboard-list"></i> Dashboard
              </a>` : ''
            }
            <a href="#" onclick="switchAccount(event)">
              <i class="fas fa-exchange-alt"></i> Switch Account
            </a>
            <div class="divider"></div>
            <a href="#" onclick="logout(event)">
              <i class="fas fa-sign-out-alt"></i> Logout
            </a>
          </div>
        `;

        // Update mobile nav
        loginNavMobile.innerHTML = `<i class="fas fa-user"></i> ${currentUserName || currentUserEmail}`;
        loginNavMobile.onclick = () => {
          toggleMobileMenu();
          toggleUserDropdown(event);
        };
      } else {
        // Reset to default login state
        loginNav.className = '';
        loginNav.innerHTML = '<i class="fas fa-user"></i> Login';
        loginNav.onclick = () => showSection('login');

        loginNavMobile.innerHTML = '<i class="fas fa-user"></i> Login';
        loginNavMobile.onclick = () => showSectionMobile('login');
      }
    }

    function toggleUserDropdown(e) {
      e.preventDefault();
      e.stopPropagation();
      const dropdown = document.getElementById('userDropdown');
      dropdown.classList.toggle('show');

      // Close dropdown when clicking outside
      document.onclick = function(event) {
        if (!event.target.closest('.user-dropdown')) {
          dropdown.classList.remove('show');
        }
      };
    }

    function switchAccount(e) {
      e.preventDefault();
      currentUserEmail = '';
      currentUserName = '';
      currentUserRole = '';
      currentUserDepartment = '';
      adminMode = false;
      updateNavigation();
      showSection('login');
      showNotification('info', 'Switch Account', 'Please login with different credentials.');
    }

    function logout(e) {
      if (e) {
        e.preventDefault();
      }
      if (currentUserEmail) {
        socket.emit('leave_room', currentUserEmail);
      }
      if (adminMode) {
        socket.emit('leave_room', 'admin');
      }
      currentUserEmail = '';
      currentUserName = '';
      currentUserRole = '';
      currentUserDepartment = '';
      adminMode = false;
      updateNavigation();
      showSection('home');
      showNotification('success', 'Logged Out', 'You have been successfully logged out.');
    }

    function toggleAdminFields() {
      const accountType = document.getElementById('accountType').value;
      const adminFields = document.getElementById('adminFields');
      adminFields.style.display = accountType === 'admin' ? 'block' : 'none';
    }

    function showUserSignup() {
      document.getElementById('adminFields').style.display = 'none';
      document.getElementById('signupTitle').innerHTML = '<i class="fas fa-user-plus"></i> Create Citizen Account';
      document.getElementById('backToLogin').onclick = () => showSection('login');
      showSection('signup');
    }

    function showAdminSignup() {
      document.getElementById('adminFields').style.display = 'block';
      document.getElementById('signupTitle').innerHTML = '<i class="fas fa-user-shield"></i> Create Administrator Account';
      document.getElementById('backToLogin').onclick = () => showSection('admin-login');
      showSection('signup');
    }

    function signupUser() {
      const firstName = document.getElementById("signupFirstName").value;
      const lastName = document.getElementById("signupLastName").value;
      const email = document.getElementById("signupEmail").value;
      const password = document.getElementById("signupPassword").value;
      const confirmPassword = document.getElementById("signupConfirmPassword").value;
      
      // Password validation
      if (!password || !confirmPassword) {
        showNotification('error', 'Missing Password', "Please fill in both password fields.");
        return;
      }

      if (password.length < 6) {
        showNotification('error', 'Invalid Password', "Password must be at least 6 characters long.");
        return;
      }

      if (password !== confirmPassword) {
        showNotification('error', 'Password Mismatch', "Passwords don't match. Please try again.");
        // Clear password fields
        document.getElementById("signupPassword").value = '';
        document.getElementById("signupConfirmPassword").value = '';
        return;
      }
      
      if (users.some(u => u.email === email)) {
        showNotification('error', 'Account Exists', 'An account with this email already exists.');
        return;
      }

      const isAdmin = document.getElementById('adminFields').style.display === 'block';
      const newUser = {
        email,
        password,
        firstName,
        lastName,
        role: isAdmin ? 'admin' : 'user'
      };

      if (isAdmin) {
        const department = document.getElementById('adminDepartment').value;
        const position = document.getElementById('adminPosition').value;
        const employeeId = document.getElementById('adminEmployeeId').value;

        if (!department || !position || !employeeId) {
          showNotification('error', 'Missing Information', 'Please fill in all admin fields.');
          return;
        }

        Object.assign(newUser, {
          department,
          position,
          employeeId
        });
      }

      users.push(newUser);
      currentUserEmail = email;
      currentUserName = `${firstName} ${lastName}`;
      currentUserRole = isAdmin ? 'admin' : 'user';
      currentUserDepartment = newUser.department || '';
      
      updateNavigation();
      showSection('home');
      showNotification('success', 'Welcome!', 
        isAdmin 
          ? `Welcome to Urban Resolve, ${firstName}! Your administrator account for the ${newUser.department} department has been created successfully.`
          : `Welcome to Urban Resolve, ${firstName}! Your account has been created successfully.`
      );
    }

    function resetPassword() {
      const email = document.getElementById("resetEmail").value;
      // In a real app, this would trigger a password reset email
      showNotification('success', 'Reset Link Sent', 'If an account exists with this email, you will receive password reset instructions shortly.');
      showSection('login');
    }

    function loginUser() {
      const email = document.getElementById("loginEmail").value;
      const password = document.getElementById("loginPassword").value;
      const user = users.find(u => u.email === email && u.password === password);
      
      if (!user) {
        showNotification('error', 'Login Failed', 'Invalid email or password. Please try again.');
        return;
      }

      if (user.role === 'admin') {
        showNotification('error', 'Access Denied', 'This login is for citizens only. Please use the Admin Portal to login as an administrator.');
        return;
      }

      if (user.role === 'user') {
        currentUserEmail = email;
        currentUserName = `${user.firstName} ${user.lastName}`;
        currentUserRole = 'user';
        adminMode = false;
        joinUserRoom(email); // Join user's room
        updateNavigation();
        showSection('home');
        showNotification('success', 'Welcome Back!', `Welcome back, ${user.firstName}! You've been successfully logged in.`);
      }
    }

    function loginAdmin() {
      const email = document.getElementById("adminEmail").value;
      const password = document.getElementById("adminPassword").value;
      const user = users.find(u => u.email === email && u.password === password);
      
      if (!user) {
        showNotification('error', 'Login Failed', 'Invalid email or password. Please try again.');
        return;
      }

      if (user.role === 'user') {
        showNotification('error', 'Access Denied', 'This portal is for administrators only. Please use the regular login for citizen access.');
        return;
      }

      if (user.role === 'admin') {
        adminMode = true;
        currentUserEmail = email;
        currentUserName = `${user.firstName} ${user.lastName}`;
        currentUserRole = 'admin';
        currentUserDepartment = user.department;
        joinUserRoom(email); // Join user's room
        joinAdminRoom(); // Join admin room
        updateNavigation();
        showAdminDashboard();
        showNotification('success', 'Admin Access', `Welcome to the admin dashboard. You now have access to ${user.department === 'all' ? 'all departments' : user.department + ' department'}.`);
      }
    }

    function showAdminDashboard() {
      // Hide all other sections
      const sections = ['home', 'form-section', 'complaint-list', 'login', 'admin-login', 'signup', 'forgot-password', 'suggestions'];
      sections.forEach(section => {
        document.getElementById(section).style.display = 'none';
      });
      
      // Show admin dashboard
      document.getElementById('admin-dashboard').style.display = 'block';
      updateAdminStats();
      renderComplaintsTable();
    }

    function updateAdminStats() {
      const filteredComplaints = currentUserDepartment === 'all' 
        ? complaints 
        : complaints.filter(c => c.category === currentUserDepartment);

      const newCount = filteredComplaints.filter(c => c.status === 'Submitted').length;
      const inProgressCount = filteredComplaints.filter(c => c.status === 'In Progress').length;
      const resolvedCount = filteredComplaints.filter(c => c.status === 'Resolved').length;
      const responseRate = filteredComplaints.length > 0 
        ? Math.round((resolvedCount / filteredComplaints.length) * 100) 
        : 0;

      document.getElementById('new-complaints-count').textContent = newCount;
      document.getElementById('in-progress-count').textContent = inProgressCount;
      document.getElementById('resolved-complaints-count').textContent = resolvedCount;
      document.getElementById('response-rate').textContent = `${responseRate}%`;
    }

    function renderComplaintsTable() {
      const tbody = document.getElementById('complaints-table-body');
      tbody.innerHTML = '';

      const departmentFilter = document.getElementById('department-filter').value;
      const statusFilter = document.getElementById('status-filter').value;
      const dateFilter = document.getElementById('date-filter').value;

      let filteredComplaints = currentUserDepartment === 'all' 
        ? [...complaints] 
        : complaints.filter(c => c.category === currentUserDepartment);

      if (departmentFilter) {
        filteredComplaints = filteredComplaints.filter(c => c.category === departmentFilter);
      }
      if (statusFilter) {
        filteredComplaints = filteredComplaints.filter(c => c.status === statusFilter);
      }
      if (dateFilter) {
        filteredComplaints = filteredComplaints.filter(c => c.date === dateFilter);
      }

      filteredComplaints.forEach(complaint => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>#${complaint.id}</td>
          <td>${complaint.date}</td>
          <td>${complaint.category}</td>
          <td>${complaint.description.substring(0, 50)}...</td>
          <td>${complaint.location}</td>
          <td><span class="status-badge ${getStatusBadgeClass(complaint.status)}">${complaint.status}</span></td>
          <td class="action-buttons">
            <button onclick="updateStatus(${complaint.id}, 'In Progress')" 
                    ${complaint.status === 'In Progress' ? 'disabled' : ''}>
              <i class="fas fa-clock"></i> In Progress
            </button>
            <button onclick="updateStatus(${complaint.id}, 'Resolved')"
                    ${complaint.status === 'Resolved' ? 'disabled' : ''}>
              <i class="fas fa-check"></i> Resolve
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });
    }

    function filterComplaints() {
      renderComplaintsTable();
      updateAdminStats();
    }

    function updateStatus(id, newStatus) {
      const complaint = complaints.find((c) => c.id === id);
      if (complaint) {
        complaint.status = newStatus;
        if (adminMode) {
          renderComplaintsTable();
          updateAdminStats();
        } else {
          renderComplaints();
        }
        showNotification('success', 'Status Updated', `Complaint status has been updated to ${newStatus}`);
      }
    }

    function getStatusBadgeClass(status) {
      switch(status.toLowerCase()) {
        case 'submitted': return 'status-submitted';
        case 'in progress': return 'status-progress';
        case 'resolved': return 'status-resolved';
        default: return 'status-submitted';
      }
    }

    function renderComplaints() {
      if (!document.getElementById("complaint-list")) {
        return; // Exit if the complaint list container doesn't exist
      }
      
      const container = document.getElementById("complaint-list");
      
      // Reset the container while preserving the header structure
      container.querySelector('.card').innerHTML = `
        <h2><i class="fas fa-clipboard-list"></i> Complaint Status Dashboard</h2>
        <p class="subtitle" style="color: #666; margin-bottom: 2rem;">
          ${adminMode 
            ? `Managing complaints for ${currentUserDepartment === 'all' 
                ? 'all departments' 
                : 'the ' + currentUserDepartment + ' department'}`
            : 'Track and monitor the status of your submitted complaints'}
        </p>
        
        <div class="status-summary" style="display: flex; gap: 1rem; margin-bottom: 2rem;">
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-paper-plane fa-lg" style="color: var(--primary-color);"></i>
            <h4>Submitted</h4>
            <p id="submitted-count">0</p>
          </div>
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-clock fa-lg" style="color: var(--warning-color);"></i>
            <h4>In Progress</h4>
            <p id="progress-count">0</p>
          </div>
          <div style="flex: 1; padding: 1rem; background: #f8fafc; border-radius: 0.5rem; text-align: center;">
            <i class="fas fa-check-circle fa-lg" style="color: var(--success-color);"></i>
            <h4>Resolved</h4>
            <p id="resolved-count">0</p>
          </div>
        </div>

        <h3 style="margin-bottom: 1rem; padding-bottom: 0.5rem; border-bottom: 2px solid #e5e7eb;">
          <i class="fas fa-list"></i> ${adminMode ? 'Department Complaints' : 'Your Complaints'}
        </h3>
      `;
      
      let filtered = [];
      
      if (adminMode) {
        // For admin users
        if (currentUserDepartment === 'all') {
          filtered = [...complaints]; // Show all complaints for super admin
        } else {
          filtered = complaints.filter(c => c.category === currentUserDepartment);
        }
      } else {
        // For regular users
        filtered = complaints.filter(c => c.email === currentUserEmail);
      }
      
      console.log('Current user email:', currentUserEmail); // Debug log
      console.log('Total complaints:', complaints.length); // Debug log
      console.log('Filtered complaints:', filtered.length); // Debug log

      // Update status counts
      const counts = {
        'Submitted': filtered.filter(c => c.status === 'Submitted').length,
        'In Progress': filtered.filter(c => c.status === 'In Progress').length,
        'Resolved': filtered.filter(c => c.status === 'Resolved').length
      };
      
      document.getElementById('submitted-count').textContent = counts['Submitted'];
      document.getElementById('progress-count').textContent = counts['In Progress'];
      document.getElementById('resolved-count').textContent = counts['Resolved'];
      
      if (filtered.length === 0) {
        const noComplaints = document.createElement('div');
        noComplaints.innerHTML = `
          <div style="text-align: center; padding: 2rem; background: #f8fafc; border-radius: 0.5rem;">
            <i class="fas fa-inbox fa-3x" style="color: var(--primary-color); margin-bottom: 1rem;"></i>
            <h3 style="color: #374151; margin-bottom: 0.5rem;">No Complaints Yet</h3>
            <p style="color: #6b7280; margin-bottom: 1.5rem;">
              ${adminMode 
                ? `There are no complaints assigned to ${currentUserDepartment === 'all' 
                    ? 'any department' 
                    : 'the ' + currentUserDepartment + ' department'} yet.`
                : "You haven't submitted any complaints yet. When you do, they will appear here with their current status."}
            </p>
            ${!adminMode ? `
              <button onclick="showSection('submit')" style="margin-top: 1rem;">
                <i class="fas fa-plus-circle"></i> Submit New Complaint
              </button>
            ` : ''}
          </div>
        `;
        container.querySelector('.card').appendChild(noComplaints);
        return;
      }

      filtered.forEach((c) => {
        const card = document.createElement("div");
        card.className = "complaint-card";
        const statusClass = getStatusBadgeClass(c.status);
        
        card.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
              <strong><i class="fas fa-tag"></i> Category:</strong> ${c.category}<br>
              <strong><i class="fas fa-user"></i> Name:</strong> ${c.name}<br>
              <strong><i class="fas fa-phone"></i> Phone:</strong> ${c.phone}<br>
              <strong><i class="fas fa-envelope"></i> Email:</strong> ${c.email}<br>
              <strong><i class="fas fa-map-marker-alt"></i> Location:</strong> ${c.location}<br>
              <strong><i class="fas fa-calendar"></i> Date:</strong> ${c.date}<br>
          <p>${c.description}</p>
            </div>
            <span class="status-badge ${statusClass}">
              <i class="fas fa-info-circle"></i> ${c.status}
            </span>
          </div>
        `;

        if (adminMode) {
          const btns = document.createElement("div");
          btns.className = "admin-buttons";
          btns.innerHTML = `
            <button onclick="updateStatus(${c.id}, 'In Progress')">
              <i class="fas fa-clock"></i> Mark In Progress
            </button>
            <button onclick="updateStatus(${c.id}, 'Resolved')">
              <i class="fas fa-check"></i> Mark Resolved
            </button>
          `;
          card.appendChild(btns);
        }
        container.querySelector('.card').appendChild(card);
      });
    }

    function renderSuggestions() {
      const container = document.getElementById("suggestions-list");
      container.innerHTML = '<h3>Recent Suggestions</h3>';
      
      if (suggestions.length === 0) {
        container.innerHTML += '<p>No suggestions yet. Be the first to suggest an improvement!</p>';
        return;
      }

      suggestions.sort((a, b) => b.votes - a.votes).forEach((s) => {
        const card = document.createElement("div");
        card.className = "complaint-card";
        card.innerHTML = `
          <div style="display: flex; justify-content: space-between; align-items: start;">
            <div>
              <h4>${s.title}</h4>
              <strong><i class="fas fa-tag"></i> Category:</strong> ${s.category}<br>
              <strong><i class="fas fa-user"></i> Suggested by:</strong> ${s.name}<br>
              <strong><i class="fas fa-calendar"></i> Date:</strong> ${s.date}<br>
              <p>${s.description}</p>
            </div>
            <div>
              <button onclick="voteSuggestion(${s.id})" class="vote-button">
                <i class="fas fa-thumbs-up"></i> ${s.votes} Votes
              </button>
            </div>
          </div>
        `;
        container.appendChild(card);
      });
    }

    function voteSuggestion(id) {
      if (!currentUserEmail) {
        showNotification('warning', 'Login Required', 'Please login to vote for suggestions');
        showSection('login');
        return;
      }
      const suggestion = suggestions.find(s => s.id === id);
      if (suggestion) {
        suggestion.votes++;
        renderSuggestions();
        showNotification('success', 'Vote Recorded', 'Your vote has been recorded. Thank you for participating!');
      }
    }

    function toggleMobileMenu() {
      const mobileMenu = document.getElementById('mobileMenu');
      mobileMenu.classList.toggle('show');
      
      // Prevent body scrolling when menu is open
      document.body.style.overflow = mobileMenu.classList.contains('show') ? 'hidden' : '';
    }

    function showSectionMobile(id) {
      toggleMobileMenu(); // Close the mobile menu
      showSection(id); // Show the selected section
    }

    // Add this near the top of your JavaScript
    // Check if accessing admin portal
    window.addEventListener('load', function() {
      const adminRoute = '/admin';
      if (window.location.pathname === adminRoute) {
        showSection('admin-login');
      }
    });

    // Update the showSection function to handle admin routes
    function showSection(id) {
      const sections = ['home', 'form-section', 'complaint-list', 'login', 'admin-login', 'signup', 'forgot-password', 'suggestions', 'admin-dashboard'];
      sections.forEach(section => {
        document.getElementById(section).style.display = 'none';
      });
      
      if (id === 'submit') {
        document.getElementById('form-section').style.display = 'block';
      } else if (id === 'status') {
        document.getElementById('complaint-list').style.display = 'block';
        if (!currentUserEmail) {
          // Show login prompt if not logged in
          document.getElementById('complaint-list').style.display = 'block';
          document.querySelector('#complaint-list .card').innerHTML = `
            <h2><i class="fas fa-clipboard-list"></i> Complaint Status Dashboard</h2>
            <p class="subtitle" style="color: #666; margin-bottom: 2rem;">Track and monitor the status of your submitted complaints</p>
            
            <div style="text-align: center; padding: 3rem; background: #f8fafc; border-radius: 0.5rem; margin-top: 2rem;">
              <i class="fas fa-user-lock fa-3x" style="color: var(--primary-color); margin-bottom: 1rem;"></i>
              <h3 style="color: #374151; margin-bottom: 0.5rem;">Please Login to View Your Complaints</h3>
              <p style="color: #6b7280; margin-bottom: 1.5rem;">You need to be logged in to view and track your complaints.</p>
              <div style="display: flex; gap: 1rem; justify-content: center;">
                <button onclick="showSection('login')" style="background-color: var(--primary-color);">
                  <i class="fas fa-sign-in-alt"></i> Login
                </button>
                <button onclick="showSection('signup')" style="background-color: var(--secondary-color);">
                  <i class="fas fa-user-plus"></i> Create Account
                </button>
              </div>
            </div>
          `;
        } else {
          renderComplaints();
        }
      } else {
        document.getElementById(id).style.display = 'block';
      }

      if (id === 'suggestions') {
        renderSuggestions();
      }

      // Update URL for admin routes
      if (id === 'admin-login' || id === 'admin-dashboard') {
        window.history.pushState({}, '', '/admin');
      }
    }

    // Add a direct admin access function
    function accessAdminPortal() {
      window.location.href = window.location.origin + '/admin';
    }

    // Initialize the app
    updateNavigation();
    showSection('home');
  </script>
</body>
</html>
